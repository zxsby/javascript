{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/observer/index.js","../../src/util.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["// 拿到数组原型上的方法 （原有方法）\r\nlet oldArrayProtoMethds = Array.prototype\r\n\r\n//继承一下\r\n\r\nexport let arrayMethods = Object.create(oldArrayProtoMethds)\r\n\r\nlet methods =[\r\n    'push',\r\n    'pop',\r\n    'shift',\r\n    'unshift',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n]\r\nmethods.forEach(method=>{\r\n    arrayMethods[method] = function(...args){\r\n        const result = oldArrayProtoMethds[method].apply(this,args) // this就是Observer里的value\r\n        let inserted;\r\n        switch (method) {\r\n            case 'push': // arr.push({a:1},{b:2})\r\n            case 'unshift': //这两个方法都是追加 追加的内容可能是对象类型，应该被再次进行劫持\r\n                inserted = args;\r\n                break;\r\n            case 'splice': // vue.$set原理\r\n                inserted = args.slice(2); // arr.splice(0,1,{a:1},{a:1},{a:1})\r\n            default:\r\n                break;\r\n        }\r\n        if(inserted) this.__ob__.observeArray(inserted)    //给数组新增值也添加观测\r\n        return result\r\n    }\r\n})","import { arrayMethods } from \"./array\"\r\n\r\nclass Observer{\r\n    constructor(value){\r\n        //判断是否被观测过\r\n        Object.defineProperty(value,'__ob__',{\r\n            enumerable:false, // 不能被枚举 ，不能被循环\r\n            configurable:false,\r\n            value:this\r\n        })\r\n        // 使用defineProperty 重新定义属性\r\n        if(Array.isArray(value)){\r\n            //调用push shift unshift splice sort reverse pop \r\n            //函数劫持，切片编程\r\n            value.__proto__ = arrayMethods\r\n            this.observeArray(value)\r\n        }else{\r\n            this.walk(value)\r\n        }\r\n    }\r\n    observeArray(value){ //观测数组\r\n        value.forEach(item =>{\r\n            observer(item)//观测数组中的对象\r\n        })\r\n    }\r\n    walk(data){\r\n        let keys = Object.keys(data)// 获取对象的key\r\n        keys.forEach(key =>{\r\n            defineReactive(data,key,data[key])\r\n        })\r\n    }\r\n}\r\n\r\nfunction defineReactive(data,key,value){\r\n    observer(value)\r\n    Object.defineProperty(data,key,{\r\n        get(){\r\n            return value\r\n        },\r\n        set(newValue){\r\n            if(newValue == value) return;\r\n            observer(newValue)\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\nexport function observer(data){\r\n    if(typeof data !== 'object' || data == null){\r\n        return\r\n    }\r\n    if(data.__ob__){\r\n        return\r\n    }\r\n    return new Observer(data)\r\n}","export function Proxy(vm,data,key) {\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[data][key]\r\n        },\r\n        set(newValue){\r\n            vm[data][key] = newValue\r\n        }\r\n    })\r\n}","import { observer } from \"./observer/index\"\r\nimport { Proxy } from \"./util\"\r\n\r\nexport function initState (vm){ // vm.$options\r\n    const opts = vm.$options\r\n    if(opts.props){\r\n        initProps(vm)\r\n    }\r\n    if(opts.methods){\r\n        initMethods(vm)\r\n    }\r\n    if(opts.data){\r\n        initData(vm)\r\n    }\r\n    if(opts.computed){\r\n        initComputed(vm)\r\n    }\r\n    if(opts.watch){\r\n        initWatch(vm)\r\n    }\r\n}\r\n\r\nfunction initProps(vm){\r\n\r\n}\r\nfunction initMethods(vm){\r\n\r\n}\r\n\r\nfunction initData(vm){\r\n    let data = vm.$options.data // 数据的初始化操作\r\n    vm._data = data = typeof data == 'function' ? data.call(vm):data\r\n\r\n\r\n    //当我去vm上取属性时，帮我将属性的取值代理到vm._data上\r\n    for(let key in data){\r\n        Proxy(vm,'_data',key)\r\n    }\r\n\r\n    //数据的劫持方案 对象的  Object.defineProperty\r\n    observer(data);\r\n    //数组是单独处理的\r\n   \r\n}\r\nfunction initComputed(vm){\r\n\r\n}\r\nfunction initWatch(vm){\r\n\r\n}","import { initState } from \"./state\";\r\n\r\nexport function initMixin(Vue){\r\n    //初始化操作\r\n    Vue.prototype._init =function (options){\r\n        const vm = this;\r\n        vm.$options = options\r\n\r\n        //初始化状态（将数据做一个初始化的劫持 当我改变数据时应该跟新视图）\r\n        initState(vm)\r\n        //vue组件中有很多状态 data props watcch computed\r\n\r\n\r\n        //vue里面核心特性 响应式数据原理\r\n        //vue 是一个什么样的框架 \r\n\r\n        // MVVM 数据变化视图会更新，视图变化数据会被影响 MVVM不能跳过数据取跟新视图\r\n    }\r\n}","// new Vue({})\r\n\r\nimport { initMixin } from \"./init\"\r\n\r\n// es6的类的写法 一个整体\r\n\r\nfunction Vue(options){\r\n    this._init(options) // 入口方法，做初始化操作 \r\n}\r\n\r\ninitMixin(Vue)\r\n\r\n\r\n\r\nexport default Vue"],"names":["oldArrayProtoMethds","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","result","apply","inserted","slice","__ob__","observeArray","Observer","value","defineProperty","enumerable","configurable","isArray","__proto__","walk","item","observer","data","keys","key","defineReactive","get","set","newValue","Proxy","vm","initState","opts","$options","props","initData","computed","watch","_data","call","initMixin","Vue","_init","options"],"mappings":"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"}