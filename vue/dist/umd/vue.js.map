{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/util.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/parse.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/vode/patch.js","../../src/lifecycle.js","../../src/init.js","../../src/vode/index.js","../../src/index.js"],"sourcesContent":["// 拿到数组原型上的方法 （原有方法）\r\nlet oldArrayProtoMethds = Array.prototype\r\n\r\n//继承一下\r\n\r\nexport let arrayMethods = Object.create(oldArrayProtoMethds)\r\n\r\nlet methods =[\r\n    'push',\r\n    'pop',\r\n    'shift',\r\n    'unshift',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n]\r\nmethods.forEach(method=>{\r\n    arrayMethods[method] = function(...args){\r\n        const result = oldArrayProtoMethds[method].apply(this,args) // this就是Observer里的value\r\n        let inserted;\r\n        switch (method) {\r\n            case 'push': // arr.push({a:1},{b:2})\r\n            case 'unshift': //这两个方法都是追加 追加的内容可能是对象类型，应该被再次进行劫持\r\n                inserted = args;\r\n                break;\r\n            case 'splice': // vue.$set原理\r\n                inserted = args.slice(2); // arr.splice(0,1,{a:1},{a:1},{a:1})\r\n            default:\r\n                break;\r\n        }\r\n        if(inserted) this.__ob__.observeArray(inserted)    //给数组新增值也添加观测\r\n        return result\r\n    }\r\n})","export function Proxy(vm,data,key) {\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[data][key]\r\n        },\r\n        set(newValue){\r\n            vm[data][key] = newValue\r\n        }\r\n    })\r\n}\r\n\r\nexport function defineProperty(value,key,that){\r\n    Object.defineProperty(value,key,{\r\n        enumerable:false, // 不能被枚举 ，不能被循环\r\n        configurable:false,\r\n        value:that\r\n    })\r\n}","import { arrayMethods } from \"./array\"\r\nimport { defineProperty } from \"../util.js\"\r\n\r\nclass Observer{\r\n    constructor(value){\r\n        //判断是否被观测过\r\n        defineProperty(value,'__ob__',this)\r\n        // Object.defineProperty(value,'__ob__',{\r\n        //     enumerable:false, // 不能被枚举 ，不能被循环\r\n        //     configurable:false,\r\n        //     value:this\r\n        // })\r\n        // 使用defineProperty 重新定义属性\r\n        if(Array.isArray(value)){\r\n            //调用push shift unshift splice sort reverse pop \r\n            //函数劫持，切片编程\r\n            value.__proto__ = arrayMethods\r\n            this.observeArray(value)\r\n        }else{\r\n            this.walk(value)\r\n        }\r\n    }\r\n    observeArray(value){ //观测数组\r\n        value.forEach(item =>{\r\n            observer(item)//观测数组中的对象\r\n        })\r\n    }\r\n    walk(data){\r\n        let keys = Object.keys(data)// 获取对象的key\r\n        keys.forEach(key =>{\r\n            defineReactive(data,key,data[key])\r\n        })\r\n    }\r\n}\r\n\r\nfunction defineReactive(data,key,value){\r\n    observer(value)\r\n    Object.defineProperty(data,key,{\r\n        get(){\r\n            return value\r\n        },\r\n        set(newValue){\r\n            if(newValue == value) return;\r\n            observer(newValue)\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\nexport function observer(data){\r\n    if(typeof data !== 'object' || data == null){\r\n        return\r\n    }\r\n    if(data.__ob__){\r\n        return\r\n    }\r\n    return new Observer(data)\r\n}","import { observer } from \"./observer/index\"\r\nimport { Proxy } from \"./util.js\"\r\n\r\nexport function initState (vm){ // vm.$options\r\n    const opts = vm.$options\r\n    if(opts.props){\r\n        initProps(vm)\r\n    }\r\n    if(opts.methods){\r\n        initMethods(vm)\r\n    }\r\n    if(opts.data){\r\n        initData(vm)\r\n    }\r\n    if(opts.computed){\r\n        initComputed(vm)\r\n    }\r\n    if(opts.watch){\r\n        initWatch(vm)\r\n    }\r\n}\r\n\r\nfunction initProps(vm){\r\n\r\n}\r\nfunction initMethods(vm){\r\n\r\n}\r\n\r\nfunction initData(vm){\r\n    let data = vm.$options.data // 数据的初始化操作\r\n    vm._data = data = typeof data == 'function' ? data.call(vm):data\r\n\r\n\r\n    //当我去vm上取属性时，帮我将属性的取值代理到vm._data上\r\n    for(let key in data){\r\n        Proxy(vm,'_data',key)\r\n    }\r\n\r\n    //数据的劫持方案 对象的  Object.defineProperty\r\n    observer(data);\r\n    //数组是单独处理的\r\n   \r\n}\r\nfunction initComputed(vm){\r\n\r\n}\r\nfunction initWatch(vm){\r\n\r\n}","\r\n\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名\r\n// ?:匹配不捕获\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // </my:xx>\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的    aaa=\"aaa\"  a='aaa'   a=aaa\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >    >   <div></div>  <br/>\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;\r\n// 数据结构 树、栈、链表、队列、\r\nexport function parseHTML(html) {\r\n    function createASTElement(tagName, attrs) {\r\n        return {\r\n            tag: tagName, // 标签名\r\n            type: 1, // 元素类型\r\n            children: [], // 孩子列表\r\n            attrs, // 属性集合\r\n            parent: null // 父元素\r\n        }\r\n    }\r\n    let root;\r\n    let currentParent;\r\n    let stack = [];\r\n    function start(tagName, attrs) { // 创建一个元素 作为根元素\r\n        let element = createASTElement(tagName, attrs);\r\n        if(!root){\r\n            root = element;\r\n        }\r\n        currentParent = element; // 当前解析的标签 保存起来\r\n        stack.push(element); // 将生产的ast元素放到栈中\r\n    }\r\n\r\n    // <div> <p></p> hello</div>    currentParent=p\r\n    function end(tagName) { // 在结尾标签处 创建父子关系\r\n        let element = stack.pop(); // 取出栈中的最后一个\r\n        currentParent = stack[stack.length-1];\r\n        if(currentParent){ // 在闭合时可以知道这个标签的父亲是谁\r\n            element.parent = currentParent;\r\n            currentParent.children.push(element);\r\n        }\r\n    }\r\n    function chars(text) {\r\n        text = text.trim();\r\n        if(text){\r\n            currentParent.children.push({\r\n                type:3,\r\n                text\r\n            })\r\n        }\r\n    }\r\n\r\n    while (html) { // 只要html不为空字符串就一直解析\r\n        let textEnd = html.indexOf('<');\r\n        if (textEnd == 0) {\r\n            // 肯定是标签\r\n            const startTagMatch = parseStartTag(); // 开始标签匹配的结果 处理开始\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs);\r\n                continue;\r\n            }\r\n            const endTagMatch = html.match(endTag);\r\n            if (endTagMatch) { // 处理结束标签\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1]); // 将结束标签传入 \r\n                continue;\r\n            }\r\n        }\r\n        let text;\r\n        if (textEnd > 0) { // 是处理文本\r\n            text = html.substring(0, textEnd)\r\n        }\r\n        if (text) { // 处理文本\r\n            advance(text.length);\r\n            chars(text);\r\n        }\r\n\r\n    }\r\n\r\n    function advance(n) { // 将字符串进行截取操作 在更新html内容\r\n        html = html.substring(n)\r\n    }\r\n\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen);\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length); // 删除开始标签\r\n            // 如果直接是闭合标签了 说明没有属性\r\n            let end, attr;\r\n            // 不是结尾标签 能匹配到属性\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] });\r\n                advance(attr[0].length); // 去掉当前属性\r\n            }\r\n            if (end) { // >  删除匹配到的结束标签\r\n                advance(end[0].length);\r\n                return match;\r\n            }\r\n        }\r\n    }\r\n\r\n    return root;\r\n}","// 编写<div id=\"app\" style=\"color:red\"> hello {{name}} <span>hello</span></div>\r\n\r\n// 结果:render(){\r\n//    return _c('div',{id:'app',style:{color:'red'}},_v('hello'+_s(name)),_c('span',null,_v('hello')))\r\n//}\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;\r\n//  语法层面的转义\r\nfunction genProps(attrs) { //  id   \"app\"     / style  \"fontSize:12px;color:red\"\r\n    let str = '';\r\n    for (let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i];\r\n        if (attr.name === 'style') {\r\n            let obj = {}; // 对样式进行特殊的处理 \r\n            attr.value.split(';').forEach(item => {\r\n                let [key, value] = item.split(':');\r\n                obj[key] = value;\r\n            });\r\n            attr.value = obj;\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`;\r\n    }\r\n    return `{${str.slice(0,-1)}}`;\r\n}\r\nfunction gen(node) {\r\n    if (node.type == 1) {\r\n        return generate(node); // 生产元素节点的字符串\r\n    } else {\r\n        let text = node.text; // 获取文本\r\n        // 如果是普通文本 不带{{}}\r\n\r\n        if(!defaultTagRE.test(text)){\r\n            return `_v(${JSON.stringify(text)})` // _v('hello {{ name }} world {{msg}} aa')   => _v('hello'+_s(name) +'world' + _s(msg))\r\n        }\r\n        let tokens = []; // 存放每一段的代码\r\n        let lastIndex = defaultTagRE.lastIndex = 0; // 如果正则是全局模式 需要每次使用前置为0\r\n        let match,index; // 每次匹配到的结果\r\n\r\n        while(match = defaultTagRE.exec(text)){\r\n            index = match.index; // 保存匹配到的索引\r\n            if(index > lastIndex){\r\n                tokens.push(JSON.stringify(text.slice(lastIndex,index)))\r\n            }\r\n            tokens.push(`_s(${match[1].trim()})`);\r\n            lastIndex = index+match[0].length;\r\n        }\r\n        if(lastIndex < text.length){\r\n            tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n        }\r\n        return `_v(${tokens.join('+')})`;\r\n    }\r\n}\r\nfunction genChildren(el) {\r\n    const children = el.children;\r\n    if (children) { // 将所有转化后的儿子用逗号拼接起来\r\n        return children.map(child => gen(child)).join(',')\r\n    }\r\n}\r\nexport function generate(el) {\r\n    let children = genChildren(el);// 儿子的生成\r\n    let code = `_c('${el.tag}',${\r\n        el.attrs.length? `${genProps(el.attrs)}`:'undefined'\r\n    }${\r\n        children?`,${children}`:''\r\n    })`;\r\n    return code;\r\n}","//  <div id=\"app\">hello {{name}} <span>world</span> <p></p></div>\r\nimport { parseHTML } from \"./parse\";\r\nimport { generate } from \"./generate\";\r\n\r\n\r\nexport function compileToFunctions(template) {\r\n    // html模板 => render函数  (ast是用来描述代码的)\r\n    // 1.需要将html代码转化成\"ast\"语法树 可以用ast树来描述语言本身\r\n\r\n    // 前端必须要掌握的数据结构 (树)\r\n    let ast = parseHTML(template);\r\n\r\n    // 2.优化静态节点\r\n\r\n    // 3.通过这课树 重新的生成代码\r\n    let code = generate(ast);\r\n\r\n    // 4.将字符串变成函数 限制取值范围 通过with来进行取值 稍后调用render函数就可以通过改变this 让这个函数内部取到结果了\r\n    let render = new Function(`with(this){return ${code}}`);\r\n    return render;\r\n\r\n}\r\n\r\n\r\n","import { Proxy } from \"../util\"\r\n\r\nexport function patch(oldVnode,vnode){\r\n    //将虚拟节点转换成真实节点\r\n    \r\n    let el = createElm(vnode) //产生真实的dom\r\n    let parentElm = oldVnode.parentNode // 获取老的app的父亲\r\n    parentElm.insertBefore(el,oldVnode.nextSibling) //当前的真实元素插入到app的后面\r\n    parentElm.removeChild(oldVnode)\r\n}\r\n\r\n\r\nfunction createElm(vnode){\r\n    let {tag,children,key,data,text} = vnode\r\n    if(typeof tag == 'string'){ \r\n        vnode.el = document.createElement(tag) // 创建元素放到vnode.el上\r\n        children.forEach(child => { // 遍历儿子 将儿子渲染后的结果扔到父亲中\r\n            vnode.el.appendChild(createElm(child))\r\n        })\r\n    }else{//创建文件 放到vnode.el上\r\n        vnode.el = document.createTextNode(text)\r\n    }\r\n    return vnode.el\r\n}","import { patch } from \"./vode/patch\"\r\n\r\nexport function lifecycleMixin(Vue){\r\n    Vue.prototype._update = function(vnode){\r\n        const vm = this\r\n        console.log(vnode)\r\n        patch(vm.$el,vnode)\r\n    }\r\n}\r\n\r\nexport function mountComponent(vm,el){\r\n    //调用render方法去渲染 el属性\r\n\r\n    //先调用render方法创建虚拟节点，在将虚拟节点渲染到页面上\r\n    vm._update(vm._render())\r\n}","import { initState } from \"./state\";\r\nimport { compileToFunctions } from \"./compiler/index\";\r\nimport { mountComponent } from \"./lifecycle\";\r\n\r\nexport function initMixin(Vue){\r\n    //初始化操作\r\n    Vue.prototype._init =function (options){\r\n        const vm = this;\r\n        vm.$options = options\r\n\r\n        //初始化状态（将数据做一个初始化的劫持 当我改变数据时应该跟新视图）\r\n        initState(vm)\r\n        //vue组件中有很多状态 data props watcch computed\r\n\r\n\r\n        //vue里面核心特性 响应式数据原理\r\n        //vue 是一个什么样的框架 \r\n\r\n        // MVVM 数据变化视图会更新，视图变化数据会被影响 MVVM不能跳过数据取跟新视图\r\n\r\n\r\n        //如果当前有el属性说明要渲染模板\r\n        if(vm.$options.el){\r\n            vm.$mount(vm.$options.el)\r\n        }\r\n    }\r\n    //挂载操作\r\n    Vue.prototype.$mount = function(el){\r\n        const vm = this\r\n        const options = vm.$options\r\n        el = document.querySelector(el)\r\n        vm.$el = el\r\n        if(!options.render){\r\n            //没render 将template转换为render\r\n            let template = options.template\r\n            if(!template && el){\r\n                template = el.outerHTML\r\n            }\r\n            const render = compileToFunctions(template)\r\n            options.render = render\r\n        }\r\n        // 编译原理 将模板编译成render函数\r\n      \r\n        // 需要挂载这个组件\r\n        mountComponent(vm,el)\r\n    }\r\n\r\n    \r\n}","export function renderMixin(Vue){ //用对象来描述dom的结构\r\n    Vue.prototype._c = function(){ // 创建虚拟deom元素\r\n        return createElement(...arguments)\r\n    }\r\n    Vue.prototype._s = function(val){ // stringify\r\n        return val == null ? \"\" : (typeof val == 'object') ? JSON.stringify(val) : val\r\n    }\r\n    Vue.prototype._v = function(text){ // 创建虚拟deom文本元素\r\n        return createTextVnode(text)\r\n    }\r\n    Vue.prototype._render = function(){\r\n        const vm = this\r\n        const render = vm.$options.render\r\n        let vnode = render.call(vm)\r\n        return vnode\r\n    }\r\n}\r\n\r\nfunction createElement(tag,data={},...children){\r\n    return vnode(tag,data,data.key,children)\r\n}\r\n\r\nfunction createTextVnode(text){\r\n    return vnode(undefined,undefined,undefined,undefined,text)\r\n}\r\n\r\n// 产生虚拟dom\r\n\r\nfunction vnode(tag,data,key,children,text){\r\n    return {\r\n        tag,\r\n        data,\r\n        key,\r\n        children,\r\n        text,\r\n    }\r\n}","// new Vue({})\r\n\r\nimport { initMixin } from \"./init\"\r\nimport { lifecycleMixin } from \"./lifecycle\"\r\nimport { renderMixin } from \"./vode/index\"\r\n\r\n// es6的类的写法 一个整体\r\n\r\nfunction Vue(options){\r\n    this._init(options) // 入口方法，做初始化操作 \r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nlifecycleMixin(Vue) //混和生命周期\r\n\r\nrenderMixin(Vue)\r\n\r\nexport default Vue"],"names":["oldArrayProtoMethds","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","result","apply","inserted","slice","__ob__","observeArray","Proxy","vm","data","key","defineProperty","get","set","newValue","value","that","enumerable","configurable","Observer","isArray","__proto__","walk","item","observer","keys","defineReactive","initState","opts","$options","props","initData","computed","watch","_data","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","createASTElement","tagName","attrs","tag","type","children","parent","root","currentParent","stack","start","element","push","end","pop","length","chars","text","trim","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","genProps","str","i","obj","split","JSON","stringify","gen","node","generate","test","tokens","lastIndex","index","exec","join","genChildren","el","map","child","code","compileToFunctions","template","ast","render","Function","patch","oldVnode","vnode","createElm","parentElm","parentNode","insertBefore","nextSibling","removeChild","document","createElement","appendChild","createTextNode","lifecycleMixin","Vue","_update","console","log","$el","mountComponent","_render","initMixin","_init","options","$mount","querySelector","outerHTML","renderMixin","_c","arguments","_s","val","_v","createTextVnode","undefined"],"mappings":"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"}